# -*- coding: utf-8 -*-
"""
Created on Wed Jan 17 15:36:12 2024

@author: ygdegue
"""


from fpdf import FPDF

# Créer un objet PDF
pdf = FPDF()

# Ajouter une page
pdf.add_page(orientation='L')


pdf.add_font('AvenirLTProLight', '', 'AvenirLTProLight.otf', uni=True)

pdf.add_font('AvenirLTProMedium', '', 'AvenirLTProMedium.otf', uni=True)
# Définir la police et la taille
pdf.set_font('AvenirLTProMedium', size=12)

# Créer un titre centré
pdf.cell(w=0, h=10, txt="ANNEXE - LISTE DES ETABLISSEMENTS", border=0, ln=1, align='C')

# Créer un tableau avec des colonnes de largeurs différentes
# Les largeurs sont exprimées en pourcentage de la largeur de la page
col_widths = [0.02, 0.12, 0.23, 0.1, 0.2, 0.05]

# Créer une ligne d'en-tête avec un fond gris
pdf.set_fill_color(224, 228, 228)
pdf.set_font('AvenirLTProMedium', '', size=8) # police semi-grasse
for i, header in enumerate(["N°", "siret", "Nom de l'établissement", "Effectifs \n salariés", "Nature de l'activité","Adresse"]):
    pdf.cell(w=col_widths[i] * pdf.w, h=8, txt=header, border=0, ln=0, align='L', fill=True)
pdf.ln(10) # passer à la ligne suivante

# Créer une ligne de données avec des bordures
pdf.set_font('AvenirLTProMedium', size=6) # police normale
pdf.set_fill_color(255, 255, 255) # fond blanc
for i, data in enumerate(["1", "51513059900209", "GROUPEMENT D'ACTEURS ASSOCIATIFS PARTENAIRES D'ACTION SOCIALE", "50 - 99", "1ébergement médicalisé pour adultes handicapés et autre hébergement médicalisé", "12 RUE LAVOISIER 91540 MENNECY"]):
    pdf.cell(w=col_widths[i] * pdf.w, h=10, txt=data, border=1, ln=0, align='L', fill=True)
pdf.ln(10) # passer à la ligne suivante

# Enregistrer le PDF
pdf.output("U:/DI/DINNOV/7_DATA/04_Portefeuille UC/04.1_Dataviz TI/Espace de travail Servan/Personnalisation AZAE/output_pdf_test/index.pdf")
