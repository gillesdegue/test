import json
from selenium import webdriver

# Définir les paramètres pour l'impression en PDF
settings = {
    "recentDestinations": [{
        "id": "Save as PDF",
        "origin": "local",
    }],
    "selectedDestinationId": "Save as PDF",
    "version": 2
}

# Ajouter les paramètres à Chrome
prefs = {'printing.print_preview_sticky_settings.appState': json.dumps(settings)}
chrome_options = webdriver.ChromeOptions()
chrome_options.add_experimental_option('prefs', prefs)
chrome_options.add_argument('--kiosk-printing')

# Spécifier le chemin d'exportation
prefs['savefile.default_directory'] = '/chemin/vers/votre/dossier'

# Initialiser le WebDriver
driver = webdriver.Chrome(chrome_options=chrome_options, executable_path='/chemin/vers/votre/chromedriver')

# Ouvrir la page web
driver.get("https://www.example.com")

# Imprimer la page en PDF
driver.execute_script('window.print();')
